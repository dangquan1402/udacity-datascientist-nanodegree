<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>cac629ae188b47a985d9ce90f34b8b8f</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="download-data-from-kaggle" class="cell markdown"
id="IFqCETr_I4PP">
<h1>Download data from kaggle</h1>
</section>
<div class="cell markdown" id="j7D3icieIyMG">
<p><a
href="https://www.kaggle.com/datasets/cashutosh/gender-classification-dataset">Kaggle
dataset</a></p>
</div>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="cnN6VCrlIuR3" data-outputId="9ad93a90-65bf-4a1d-df0f-c6fd4a42a0e3">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget <span class="op">-</span>O data.<span class="bu">zip</span> <span class="st">&quot;https://storage.googleapis.com/kaggle-data-sets/446365/844929/bundle/archive.zip?X-Goog-Algorithm=GOOG4-RSA-SHA256&amp;X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com</span><span class="sc">%2F</span><span class="st">20230604</span><span class="sc">%2F</span><span class="st">auto</span><span class="sc">%2F</span><span class="st">storage</span><span class="sc">%2F</span><span class="st">goog4_request&amp;X-Goog-Date=20230604T111948Z&amp;X-Goog-Expires=259200&amp;X-Goog-SignedHeaders=host&amp;X-Goog-Signature=8dc4a7b8f2ab06e6c9f7ff7bca081a05abca226f846dfea024f37789cfaf2df5a76cc6ac324d6f63304658be08377c8d6aa4c8fab31126f23d05e56955c3b60e7c744e83d510cf5e0d0e2c3fe9fe02dac84c8177a5c951fc511ac307a47d2d7c84d5fd67fe6f4629ae6915401795851598a87a81619904b4743f0edf7f70c5bdffbabd2cef9a9e7e2dfb2b4146dfb7afe88774a85f02ad4d7281c42660e9e262e631779673ed2206c9fe11c297684bf7f11c9ed70b00a6dbca721f06b43f3bafde3ecd694efa1d122ace45107859350138b2d66610f77c4b2747eb87a3f8e9568b84080dc27fe25b7ca6506417bc4d6a71a307efeeacba3ad570ea60f6a9ca6e&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>--2023-06-04 12:22:56--  https://storage.googleapis.com/kaggle-data-sets/446365/844929/bundle/archive.zip?X-Goog-Algorithm=GOOG4-RSA-SHA256&amp;X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com%2F20230604%2Fauto%2Fstorage%2Fgoog4_request&amp;X-Goog-Date=20230604T111948Z&amp;X-Goog-Expires=259200&amp;X-Goog-SignedHeaders=host&amp;X-Goog-Signature=8dc4a7b8f2ab06e6c9f7ff7bca081a05abca226f846dfea024f37789cfaf2df5a76cc6ac324d6f63304658be08377c8d6aa4c8fab31126f23d05e56955c3b60e7c744e83d510cf5e0d0e2c3fe9fe02dac84c8177a5c951fc511ac307a47d2d7c84d5fd67fe6f4629ae6915401795851598a87a81619904b4743f0edf7f70c5bdffbabd2cef9a9e7e2dfb2b4146dfb7afe88774a85f02ad4d7281c42660e9e262e631779673ed2206c9fe11c297684bf7f11c9ed70b00a6dbca721f06b43f3bafde3ecd694efa1d122ace45107859350138b2d66610f77c4b2747eb87a3f8e9568b84080dc27fe25b7ca6506417bc4d6a71a307efeeacba3ad570ea60f6a9ca6e
Resolving storage.googleapis.com (storage.googleapis.com)... 172.217.218.128, 142.251.18.128, 142.250.153.128, ...
Connecting to storage.googleapis.com (storage.googleapis.com)|172.217.218.128|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 282512091 (269M) [application/zip]
Saving to: ‘data.zip’

data.zip            100%[===================&gt;] 269.42M  38.9MB/s    in 7.9s    

2023-06-04 12:23:04 (34.1 MB/s) - ‘data.zip’ saved [282512091/282512091]

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2" id="QK8dKBE4JN3u">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>unzip <span class="op">-</span>q data.<span class="bu">zip</span> <span class="op">-</span>d .</span></code></pre></div>
</div>
<section id="library" class="cell markdown" id="wG-IS2LFK-gt">
<h1>Library</h1>
</section>
<div class="cell code" data-execution_count="3"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="IAYSciZLK_7F" data-outputId="7d527dce-6e25-4063-df48-4353f469fec7">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm.autonotebook <span class="im">import</span> tqdm</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-3-e0423161b771&gt;:3: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)
  from tqdm.autonotebook import tqdm
</code></pre>
</div>
</div>
<section id="data-exploratory" class="cell markdown" id="jKyG_FEzJo8a">
<h1>Data Exploratory</h1>
</section>
<div class="cell code" data-execution_count="4" id="yKTQFQ9LJrSP">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5" id="q1XRm8ASJtMn">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>male_training_files <span class="op">=</span> glob.glob(<span class="st">&quot;Training/male/*.jpg&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>female_training_files <span class="op">=</span> glob.glob(<span class="st">&quot;Training/female/*.jpg&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>male_validation_files <span class="op">=</span> glob.glob(<span class="st">&quot;Validation/male/*.jpg&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>female_validation_files <span class="op">=</span> glob.glob(<span class="st">&quot;Validation/female/*.jpg&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="wCKIC2vIJ-FK" data-outputId="b9589a21-e431-4c61-bffd-9ace7ba2fc32">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Male:</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="bu">len</span>(male_training_files))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Male:</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="bu">len</span>(female_training_files))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Validation&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Male:</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="bu">len</span>(male_validation_files))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Male:</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="bu">len</span>(female_validation_files))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training
Male:	 23766
Male:	 23243
Validation
Male:	 5808
Male:	 5841
</code></pre>
</div>
</div>
<section id="helper-function" class="cell markdown" id="iaXG1q2_Kd2t">
<h1>Helper function</h1>
</section>
<div class="cell markdown">
<p>There are some helper function</p>
<ul>
<li>display_images: for showing images</li>
<li>AverageMeter: this class for compute and store metric/loss</li>
<li>get_accuracy: for calculating accuracy</li>
</ul>
</div>
<div class="cell code" data-execution_count="7" id="7vK6WQuSK9O9">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> display_images(images, labels): </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;showing image along with label&quot;&quot;&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    f, ax <span class="op">=</span> plt.subplots(<span class="dv">4</span>,<span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">15</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, image_id <span class="kw">in</span> <span class="bu">enumerate</span>(images[:<span class="dv">16</span>]):</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        image <span class="op">=</span> images[i]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> labels[i]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        ax[i<span class="op">//</span><span class="dv">4</span>, i<span class="op">%</span><span class="dv">4</span>].imshow(image.numpy().transpose(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)) </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        ax[i<span class="op">//</span><span class="dv">4</span>, i<span class="op">%</span><span class="dv">4</span>].axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        ax[i<span class="op">//</span><span class="dv">4</span>, i<span class="op">%</span><span class="dv">4</span>].set_title(<span class="ss">f&quot;Class: </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    plt.show() </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AverageMeter:</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Computes and stores the average and current value&quot;&quot;&quot;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.reset()</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reset(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.val <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.avg <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">sum</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update(<span class="va">self</span>, val: <span class="bu">float</span>, n: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.val <span class="op">=</span> val</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.<span class="bu">sum</span> <span class="op">+=</span> val <span class="op">*</span> n</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.count <span class="op">+=</span> n</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.avg <span class="op">=</span> <span class="va">self</span>.<span class="bu">sum</span> <span class="op">/</span> <span class="va">self</span>.count</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_accuracy(labels, outputs):</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Calculate accuracy&quot;&quot;&quot;</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    _, predicted <span class="op">=</span> torch.<span class="bu">max</span>(outputs, <span class="dv">1</span>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (labels <span class="op">==</span> predicted).<span class="bu">sum</span>() <span class="op">/</span> labels.shape[<span class="dv">0</span>]</span></code></pre></div>
</div>
<section id="dataloader" class="cell markdown" id="G_05qom9LEIc">
<h1>DataLoader</h1>
</section>
<div class="cell code" data-execution_count="8" id="-VTrfOo-LVR1">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision.transforms <span class="im">as</span> v_transforms</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Load and encode image class. Here class 0 for female, class 1 for
male.</p>
</div>
<div class="cell code" data-execution_count="9" id="stoN51zgLREf">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>train_male_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train_male_df[<span class="st">&#39;path&#39;</span>] <span class="op">=</span> male_training_files</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>train_male_df[<span class="st">&#39;encoded_class&#39;</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>train_female_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>train_female_df[<span class="st">&#39;path&#39;</span>] <span class="op">=</span> female_training_files</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>train_female_df[<span class="st">&#39;encoded_class&#39;</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> pd.concat((train_male_df, train_female_df), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> train_df.sample(frac<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">41</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>validation_male_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>validation_male_df[<span class="st">&#39;path&#39;</span>] <span class="op">=</span> male_validation_files</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>validation_male_df[<span class="st">&#39;encoded_class&#39;</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>validation_female_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>validation_female_df[<span class="st">&#39;path&#39;</span>] <span class="op">=</span> female_validation_files</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>validation_female_df[<span class="st">&#39;encoded_class&#39;</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>validation_df <span class="op">=</span> pd.concat((validation_male_df, validation_female_df), axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Show train and validation size, here, training: 470009, and
validation: 11649</p>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="jWc7v1bIL9Uq" data-outputId="a242793b-8908-48c3-e9bb-6644f97c2dd9">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>train_df.shape, validation_df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<pre><code>((47009, 2), (11649, 2))</code></pre>
</div>
</div>
<div class="cell markdown">
<p>This class created for loading data then putting to model</p>
</div>
<div class="cell code" data-execution_count="11" id="sWOyUdYXLGYX">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MaleFemaleDataset(<span class="bu">object</span>):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, data_df, transform<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_df <span class="op">=</span> data_df</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.transform <span class="op">=</span> transform</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.data_df.shape[<span class="dv">0</span>]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, idx):</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        image_path <span class="op">=</span> <span class="va">self</span>.data_df.iloc[idx][<span class="st">&#39;path&#39;</span>]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> <span class="va">self</span>.data_df.iloc[idx][<span class="st">&#39;encoded_class&#39;</span>]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        image <span class="op">=</span> Image.<span class="bu">open</span>(image_path)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.transform <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>            image <span class="op">=</span> <span class="va">self</span>.transform(image)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> image, label</span></code></pre></div>
</div>
<section id="load-sample-images" class="cell markdown"
id="RJPneRMgMblr">
<h2>Load sample images</h2>
</section>
<div class="cell markdown">
<p>Let's see some sample images</p>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:149}"
id="wSZsp2m_MdeR" data-outputId="1922738b-509b-4963-fdcf-2761b21e0702">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> Image.<span class="bu">open</span>(train_df.sample(<span class="dv">1</span>)[<span class="st">&#39;path&#39;</span>].values[<span class="dv">0</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(image.size)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>image</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(87, 115)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="12">
<p><img
src="vertopal_481d8aea3d83438094e7403a071fad0e/334c4aa61ef70930a958fb93a0dd30eeb6d393c0.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:141}"
id="-IooA24uMiY5" data-outputId="bd231167-892a-48a7-a799-ae5b910b0c13">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> Image.<span class="bu">open</span>(train_df.sample(<span class="dv">1</span>)[<span class="st">&#39;path&#39;</span>].values[<span class="dv">0</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(image.size)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>image</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(90, 107)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="13">
<p><img
src="vertopal_481d8aea3d83438094e7403a071fad0e/ddd697f4abc7a6a1ec6fd236b1e97af9c2f4d9cf.png" /></p>
</div>
</div>
<section id="transformation" class="cell markdown" id="elDj_mIIMldr">
<h1>Transformation</h1>
</section>
<div class="cell markdown">
<p>Since, images size are varying. Resize must be employeed for make
sure, all of images have same size before putting to model.</p>
</div>
<div class="cell code" data-execution_count="14" id="yFdMO9nhMypK">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>train_transform <span class="op">=</span> v_transforms.Compose(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    [v_transforms.Resize((<span class="dv">64</span>, <span class="dv">64</span>)),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>     v_transforms.ToTensor(),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>validation_transform <span class="op">=</span> v_transforms.Compose(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    [v_transforms.Resize((<span class="dv">64</span>, <span class="dv">64</span>)),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>     v_transforms.ToTensor(),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">16</span></span></code></pre></div>
</div>
<section id="dataloader" class="cell markdown" id="cUpmo13HM6Mi">
<h1>Dataloader</h1>
</section>
<div class="cell code" data-execution_count="15" id="FsK4vZPZM_2M">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> MaleFemaleDataset(data_df <span class="op">=</span>train_df, transform<span class="op">=</span>train_transform)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>validation_dataset <span class="op">=</span> MaleFemaleDataset(data_df <span class="op">=</span> validation_df, transform<span class="op">=</span>validation_transform)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>train_dataloader <span class="op">=</span> DataLoader(train_dataset, batch_size<span class="op">=</span>batch_size)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>validation_dataloader <span class="op">=</span> DataLoader(validation_dataset, batch_size<span class="op">=</span>batch_size)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="16" id="qKRZ6mJYNQcm">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch <span class="kw">in</span> train_dataloader:</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17" id="Nh1AgxuyNbKg">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>images, labels <span class="op">=</span> batch</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="X1UuWeDVNfuk" data-outputId="cf554e7c-9bf9-458f-9cff-6fcb91ecd027">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>images.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<pre><code>torch.Size([16, 3, 64, 64])</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="ynR99NIpNJQQ" data-outputId="ebdb9b9b-a541-47f2-c566-e63da2eede62">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>display_images(images, labels)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_481d8aea3d83438094e7403a071fad0e/a1df1e38384cbb4a2b48ac77afe800b993aba73b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="20" id="L6TzsERYNcNi">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using torchvision for pretrained model</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21" id="mhO0JwtNOpZj">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>quiet torchsummary</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="22" id="kXrtkCbjOUBO">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchsummary</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="23" id="BCqwnbH-Oc9z">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>alexnet_model <span class="op">=</span> torchvision.models.alexnet(weights<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="WiipWF0DOd6V" data-outputId="da6d06cd-03f7-4f9e-fb44-459045c6c7a7">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>torchsummary.summary(alexnet_model, input_size<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">64</span>, <span class="dv">64</span>), device<span class="op">=</span><span class="st">&quot;cpu&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1           [-1, 64, 15, 15]          23,296
              ReLU-2           [-1, 64, 15, 15]               0
         MaxPool2d-3             [-1, 64, 7, 7]               0
            Conv2d-4            [-1, 192, 7, 7]         307,392
              ReLU-5            [-1, 192, 7, 7]               0
         MaxPool2d-6            [-1, 192, 3, 3]               0
            Conv2d-7            [-1, 384, 3, 3]         663,936
              ReLU-8            [-1, 384, 3, 3]               0
            Conv2d-9            [-1, 256, 3, 3]         884,992
             ReLU-10            [-1, 256, 3, 3]               0
           Conv2d-11            [-1, 256, 3, 3]         590,080
             ReLU-12            [-1, 256, 3, 3]               0
        MaxPool2d-13            [-1, 256, 1, 1]               0
AdaptiveAvgPool2d-14            [-1, 256, 6, 6]               0
          Dropout-15                 [-1, 9216]               0
           Linear-16                 [-1, 4096]      37,752,832
             ReLU-17                 [-1, 4096]               0
          Dropout-18                 [-1, 4096]               0
           Linear-19                 [-1, 4096]      16,781,312
             ReLU-20                 [-1, 4096]               0
           Linear-21                 [-1, 1000]       4,097,000
================================================================
Total params: 61,100,840
Trainable params: 61,100,840
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.05
Forward/backward pass size (MB): 0.83
Params size (MB): 233.08
Estimated Total Size (MB): 233.96
----------------------------------------------------------------
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Above is summarization of alexnetmode. It contains parameter size,
and model size as well.</p>
</div>
<div class="cell markdown">
<p>Now, let's creating a model based on alexnet. Here, we have the
number of class is 2. First, we get the base model from alexnet, then
flatten these feature, then use a fully connected layer with output size
is 2 (number of classes).</p>
</div>
<div class="cell code" data-execution_count="25" id="OUV3XfvUOSks">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SamplePretrainedModel(nn.Module):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_classes):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(SamplePretrainedModel, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_classes <span class="op">=</span> num_classes</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.base_model <span class="op">=</span> torchvision.models.alexnet(pretrained<span class="op">=</span><span class="va">True</span>).features</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc <span class="op">=</span> nn.Linear(<span class="dv">256</span>, num_classes)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.base_model(x)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.flatten(x, start_dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc(x)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_NFSUU1EO-0f" data-outputId="55ffddc4-cd2a-4922-d165-a3fd0fc7c671">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> SamplePretrainedModel(num_classes<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter &#39;pretrained&#39; is deprecated since 0.13 and may be removed in the future, please use &#39;weights&#39; instead.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for &#39;weights&#39; are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: &quot;https://download.pytorch.org/models/alexnet-owt-7be5be79.pth&quot; to /root/.cache/torch/hub/checkpoints/alexnet-owt-7be5be79.pth
100%|██████████| 233M/233M [00:05&lt;00:00, 48.3MB/s]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="27"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Pmgn8v9uPCHE" data-outputId="723d6898-f75d-496a-df12-046a52f07250">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure output is 2 classes</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>model(torch.rand(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">64</span>, <span class="dv">64</span>)).shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="27">
<pre><code>torch.Size([1, 2])</code></pre>
</div>
</div>
<section id="trainer" class="cell markdown" id="Y02421mnSZoe">
<h1>Trainer</h1>
</section>
<div class="cell markdown">
<p>This class for training and evaluation as well. After each epoch,
model will be evaluated on evaluation data, the result will be
logged.</p>
</div>
<div class="cell code" data-execution_count="33" id="EYNft5hFPL3T">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trainer:</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>, model, train_dataloader, valid_dataloader, optimizer, criterion, device, num_epoch<span class="op">=</span><span class="dv">20</span>, weight_path<span class="op">=</span><span class="st">&quot;weights&quot;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.train_dataloader <span class="op">=</span> train_dataloader</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.valid_dataloader <span class="op">=</span> valid_dataloader</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.optimizer <span class="op">=</span> optimizer</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.criterion <span class="op">=</span> criterion</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.device <span class="op">=</span> device</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_epoch <span class="op">=</span> num_epoch</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> model</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.weight_path <span class="op">=</span> weight_path</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="va">self</span>.weight_path):</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>            os.makedirs(<span class="va">self</span>.weight_path)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.losses <span class="op">=</span> {<span class="st">&quot;train&quot;</span>: [], <span class="st">&quot;validation&quot;</span>: []}</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.accuracy <span class="op">=</span> {<span class="st">&quot;train&quot;</span>: [], <span class="st">&quot;validation&quot;</span>: []}</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_one_epoch(<span class="va">self</span>):</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.train()</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        losses <span class="op">=</span> AverageMeter()</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        avg_score <span class="op">=</span> AverageMeter()</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>        tk0 <span class="op">=</span> tqdm(<span class="va">self</span>.train_dataloader, total<span class="op">=</span><span class="bu">len</span>(<span class="va">self</span>.train_dataloader))</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, (inputs, labels) <span class="kw">in</span> <span class="bu">enumerate</span>(tk0, <span class="dv">0</span>):</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(<span class="va">self</span>.device)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>            labels <span class="op">=</span> labels.to(<span class="va">self</span>.device)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># zero the parameter gradients</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.optimizer.zero_grad()</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># forward + backward + optimize</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> <span class="va">self</span>.model(inputs)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> <span class="va">self</span>.criterion(outputs, labels)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>            batch_score <span class="op">=</span> get_accuracy(labels, outputs.detach()).data.item()</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>            avg_score.update(batch_score, inputs.shape[<span class="dv">0</span>])</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>            losses.update(loss.data.item(), inputs.shape[<span class="dv">0</span>])</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.optimizer.step()</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>            tk0.set_postfix(loss<span class="op">=</span>losses.avg, avg_score<span class="op">=</span>avg_score.avg)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.losses[<span class="st">&quot;train&quot;</span>].append(losses.avg)</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.accuracy[<span class="st">&quot;train&quot;</span>].append(avg_score.avg)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> eval_one_epoch(<span class="va">self</span>):</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.<span class="bu">eval</span>()</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>        losses <span class="op">=</span> AverageMeter()</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>        avg_score <span class="op">=</span> AverageMeter()</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>        tk0 <span class="op">=</span> tqdm(<span class="va">self</span>.valid_dataloader, total<span class="op">=</span><span class="bu">len</span>(<span class="va">self</span>.valid_dataloader))</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, (inputs, labels) <span class="kw">in</span> <span class="bu">enumerate</span>(tk0, <span class="dv">0</span>):</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>                inputs <span class="op">=</span> inputs.to(<span class="va">self</span>.device)</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>                labels <span class="op">=</span> labels.to(<span class="va">self</span>.device)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>                outputs <span class="op">=</span> <span class="va">self</span>.model(inputs)</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> <span class="va">self</span>.criterion(outputs, labels)</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>                batch_score <span class="op">=</span> get_accuracy(labels, outputs.detach()).data.item()</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>                avg_score.update(batch_score, inputs.shape[<span class="dv">0</span>])</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>                losses.update(loss.data.item(), inputs.shape[<span class="dv">0</span>])</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>                tk0.set_postfix(eval_loss<span class="op">=</span>losses.avg, eval_avg_score<span class="op">=</span>avg_score.avg)</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.losses[<span class="st">&quot;validation&quot;</span>].append(losses.avg)</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.accuracy[<span class="st">&quot;validation&quot;</span>].append(avg_score.avg)</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train(<span class="va">self</span>):</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.to(<span class="va">self</span>.device)</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_epoch):</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Training </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.train_one_epoch()</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Eval epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.eval_one_epoch()</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>            torch.save(<span class="va">self</span>.model.state_dict(), os.path.join(<span class="va">self</span>.weight_path, <span class="ss">f&quot;epoch_</span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">.pt&quot;</span>))</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>        </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="34" id="jto5rJX1SgBF">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.Adam(model.parameters())</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> torch.device(<span class="st">&quot;cuda&quot;</span>) <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> torch.device(<span class="st">&quot;cpu&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="35" id="OgdHByauSmzh">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>trainer <span class="op">=</span> Trainer(model, train_dataloader, validation_dataloader, optimizer<span class="op">=</span>optimizer, criterion<span class="op">=</span>criterion, device<span class="op">=</span>device)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000,&quot;referenced_widgets&quot;:[&quot;e1852ed23eb34ac88d0c2dbd1b1a6283&quot;,&quot;6d92103128c34fd28cf4203a42763ed4&quot;,&quot;2f29f9cc65794a219f945493bf521aac&quot;,&quot;ade8371eb39d432782d13821627dd763&quot;,&quot;9c65713bd8e24efba6cc611030214287&quot;,&quot;dc02b7a758b04430b27f00d334abfdd2&quot;,&quot;99fbf005d423438dbe1bbc87b452d818&quot;,&quot;af43bcfcd68a452594c705c377af1bfc&quot;,&quot;f3a9e811cfcd4964af8d80d0ed4819d0&quot;,&quot;08667a9eebbc4c7794ff98afeeb186cd&quot;,&quot;bbb80142c37047f7b9d960330dff6f31&quot;,&quot;f42ff74879cb41f0a48b1c22ad716f6c&quot;,&quot;f918e891acc447e389fd5fe8c8f987f6&quot;,&quot;ddcdbdf0a9b146e1a6b669dcdafa3b58&quot;,&quot;28158b7586624117ac16ee5e31e4fa78&quot;,&quot;a3505c5c198c4fb08c3bde17d11c832e&quot;,&quot;3db0fd51e37646608cb33fc518b29536&quot;,&quot;cd2eb8bba04549c4aa81fb4b937f1738&quot;,&quot;76ff4112cd5a4475a7f6ab7800d9d1d4&quot;,&quot;6e30459dd3ee4e139aec6e75816d06a2&quot;,&quot;63c707ad600c4672b6af23490050b30a&quot;,&quot;d2f84d3d078b40a8a6c93fe824a146bb&quot;,&quot;380d84d18c7c4b388fdf42dce2dc3157&quot;,&quot;e685ab92708d46f5bc04ecd41796fa7f&quot;,&quot;686656b4a50d4fe19351606c56fd8cc9&quot;,&quot;1dc89d890ab6467b997dd3978b6fa3e5&quot;,&quot;dd1b312958954bbf81312f6bd05a7ca6&quot;,&quot;a429be5fc31841eb82a08cd4b86cebb3&quot;,&quot;782046a3433e426881797e157e54d552&quot;,&quot;244007471f3a4225a42417ad7723cb33&quot;,&quot;597c64b586f74f25845956d600cec840&quot;,&quot;c1b35b5041c74db4972bc0a38d6228f4&quot;,&quot;ad360a371b8a4475afd7e5dbd7d0f5b8&quot;,&quot;7734b9f1d288446f9177100f8ddde002&quot;,&quot;8206bc9646e7430bb274e00ccf4e4a10&quot;,&quot;8ddec5f1b8f847499b829306681e4477&quot;,&quot;77418b3d444341e08f3b01abcc0bb589&quot;,&quot;b0984c4881a34680b8c2323d3f0121dc&quot;,&quot;e2cb730c243745f6bdeded3ed3d7e4e6&quot;,&quot;ad1104b4d6c6477587928ff513cd6a82&quot;,&quot;7cfd7eeb14324171b99869b783e4272b&quot;,&quot;26d0e0ba2af64127b17aebdac84bb442&quot;,&quot;ec0ec96b834646dea8c83e9d0831c0b9&quot;,&quot;2edafce1e2aa421d8873b803afe59052&quot;,&quot;08f9d8ad54f944498a903b7313900481&quot;,&quot;d0f3e4ab1ef240f1809b4acaa1edca69&quot;,&quot;17134ea637c440a3adb547773d73cc93&quot;,&quot;6223d4c7237d43f38888440ca25df25d&quot;,&quot;d4a8e2a6cdf54a628ab112a1d73f5f35&quot;,&quot;d3fb0f2a6a36470786017429d8724e28&quot;,&quot;35f059cf4a4244e8aeb01b902e8d0d2a&quot;,&quot;45f0076606824081a8cef296244ac90b&quot;,&quot;4da9ea966b4f44f7a0be4cb5d930348f&quot;,&quot;d6540851071241ccbae4024c5b9b7189&quot;,&quot;4f88a5e8785041a399e83c1b217706ef&quot;,&quot;721649f021154453b05dec6fb1f19afb&quot;,&quot;298aa9b4d8b44931ba4ff047fdc6f9ce&quot;,&quot;4514b6047f574f18a8119d4b979a5d90&quot;,&quot;2abe7f38443743b6a9ccad5de0ed9e09&quot;,&quot;8e0acc59d9fb4893a5306a3302e93faf&quot;,&quot;ff64924ae12d4a13be26e720641802d1&quot;,&quot;920e0327b16644248ee7966458d526cd&quot;,&quot;51a96d1c0f574dcba943daea3787a25e&quot;,&quot;5a7d0a2ac46d494ca07209b867029399&quot;,&quot;3662314196464643823952a45bfad3e9&quot;,&quot;fb600c82222d455fb42c852b14aba29b&quot;,&quot;bc13945d02da4aa3adfe81457bbce05b&quot;,&quot;90666883c77f44889554c35e541ae5c6&quot;,&quot;0ee11e7a072b41498c45953cf9ec2a90&quot;,&quot;2cc6deb041794799bcbc530cc9978646&quot;,&quot;75656bbbc66d4038a1ea18511e3ea6a3&quot;,&quot;8493b11382b742b6ae916be6dbe1fae0&quot;,&quot;8d550c520a974815a849a3e0a9b0019a&quot;,&quot;12ee7f21b2f44a8ca8390a2cad48e562&quot;,&quot;827237559d6340aca89f11faeeafc144&quot;,&quot;8f50d608e0c24ea6bc3e709d8df71e1a&quot;,&quot;114c31beb9cd468d85f25bf912654b80&quot;,&quot;ff865bf1912542aba648f60f9541db53&quot;,&quot;fff313b35c864b8b94e7a90181e20bd2&quot;,&quot;aedb92ab042847c393e69a7656f4980e&quot;,&quot;686708ecc04b42e18b437568fc1c37cd&quot;,&quot;7ac1b9cecf7b4f42b19f5be70e871257&quot;,&quot;497ff761fd354830b43b25551a6c43e7&quot;,&quot;cd75a860458648698dfe6e120557e16e&quot;,&quot;a1cf0990653a4c01ba303cbb42e06749&quot;,&quot;37b1bb04c6e2413f829e94e496d721f2&quot;,&quot;46439f2d886b4911922c6bbd588d8f3c&quot;,&quot;aaae9d08c1b644a899b470aedfc75aac&quot;,&quot;e910eddbbc334967a3341e1186585291&quot;,&quot;feaf8c647ad54110ab71a14bbb581f51&quot;,&quot;78dcbff863014717acca426429d34703&quot;,&quot;ca308692ce5d4d878d2586d3fd1cf424&quot;,&quot;5230bf4f5ecf4b74ab1cda62060f0466&quot;,&quot;aa1b1552f7ca441fad552ebfefd9dad5&quot;,&quot;66df4e1f31c84183a11ea0da31e87a25&quot;,&quot;83d066b8aad94dbf9dc7512a30f4b733&quot;,&quot;a2252bb5bb644cefba5fa3c0c23375e2&quot;,&quot;099fa1ac72354a57ac11a645719e2d5a&quot;,&quot;6a835d13e7424ccaab1bc4a873bb8550&quot;,&quot;d11722b4023840319531a6f8ad3c9fb3&quot;,&quot;6287026cbe334a36b4277db1060f5499&quot;,&quot;9eef439bdbfe418695220cdfcbaa7a83&quot;,&quot;501a076384454641a83f649346c1150b&quot;,&quot;22757c6c33224e8eae6e209426948470&quot;,&quot;7eec7b4d2f7c4ae0b0904f3bdc0faf6c&quot;,&quot;6a855935b3044331a62f12bee7a54864&quot;,&quot;91ebc3f746854bf3bd440d7e5e3b3f80&quot;,&quot;b2623518b09a45cf9b732c15394c7dd6&quot;,&quot;789071c31e5048838d704f33b312fa01&quot;,&quot;be7e0aa05d7b47e28537500997e14303&quot;,&quot;86ec737c4d4e450e844922bc7b40e14f&quot;,&quot;d41efae423954644acb5f4c101491023&quot;,&quot;4c4f95e8793f496ba9dc994c46635fc0&quot;,&quot;82c1cced56024269a64a0fb10ed42e03&quot;,&quot;89b7cb4969a64f75bdb15515308ebc25&quot;,&quot;18c0000eda8d412bb2d4c15ed1ce24dd&quot;,&quot;484f6d0a7ee94653b6f6404c79720df2&quot;,&quot;3b863bf1ae72460caeef010fb1077fdf&quot;,&quot;a2ce4e1a49e9488d921fe707db334158&quot;,&quot;0725798ec5714278a4150b383664a519&quot;,&quot;d9ddaf0467934e9cb244a324775af891&quot;,&quot;d8e08b3b40ca4b3897e7f39e8529b97a&quot;,&quot;d41902485e0d42d3a1f56ad5508a0ee0&quot;,&quot;c29222a1523c4523a5120223bb58a0c2&quot;,&quot;73ae1de76d244ba0962dbb965769113b&quot;,&quot;c2a247c62cc04fa382196639611a4ee0&quot;,&quot;737b65ef21bf4033829f626468f65379&quot;,&quot;10f781327eed46c0b42d9e67c0164f39&quot;,&quot;6a3cf170e7c64ee3914a124a76d08582&quot;,&quot;7725224994924244b1ec8264ddb4c8fb&quot;,&quot;f4e9218e90204d0fbd1abfeafb88a71e&quot;,&quot;d58517fb8978443c8a88e62c9919805c&quot;,&quot;83526eae384d406fb05a8eeb84aa5bac&quot;,&quot;91dab7a847fd4e8da8a711a0788816c3&quot;,&quot;3627b082284843ebb8d413dacc5b5612&quot;,&quot;6fc130c1e81f40d7a39e70dc01e28d7d&quot;,&quot;5d19d17ffc0d43be8c91d3d4108d17d5&quot;,&quot;0a43455db66b494697db8f06e67de72e&quot;,&quot;3b877696a5894fe8a310db7799077e54&quot;,&quot;350cea00883a4150b877ae65db41bb6d&quot;,&quot;08850210b09741ecbd73b4caa8251bde&quot;,&quot;3735f1873bbc4c72a1fc041feb1286c9&quot;,&quot;ebddcf6491e94c01ada70d3c43ca4e5e&quot;,&quot;2ed1275dc5764355b02c52ce9d6c6154&quot;,&quot;18bb6c0556364cc4b7753464fa2a9668&quot;,&quot;176c187c353342909e6d3ece224b8eea&quot;,&quot;ea39e7cb75884dbb899323cbfbb52914&quot;,&quot;93898b397ded41a790448532f54484b0&quot;,&quot;f4861944adba487281e9a3cbcb9a503b&quot;,&quot;40897b82d2964e2ea3ad33eb68d692c7&quot;,&quot;5300fa66a1be41f29c5698674cc76850&quot;,&quot;f624a10f85aa4ba4b62091785ef29a56&quot;,&quot;c8fd7a09101541558cb297b0c9298be7&quot;,&quot;0772087abdf54cc39884960f2caa3d17&quot;,&quot;4b9d4fb0ed41414c9fb30a7fe3611cd1&quot;,&quot;9e7a3de35ac147d08cf16d6a2c2f2b9b&quot;,&quot;9feeafe48d5a4a1492533ff1914a47b6&quot;,&quot;70efc2f2005a426f8422cd32467e1fae&quot;,&quot;52a090884a5847b7a8377ddef807529d&quot;,&quot;bdc54a52a41a4547a1cdba780a710882&quot;,&quot;267cbfab10964637b2e92628e978d256&quot;,&quot;30d6ffae7ee447bc8e3aabb21a67aa92&quot;,&quot;2c2b52db087a41309788edce6a16a070&quot;,&quot;6ae51cf203b2409abdc199d9a03e7487&quot;,&quot;f033dc93137148d987926a110a85426a&quot;,&quot;21bf468c99eb4c39b50237abd9af3d83&quot;,&quot;0559d0952e8c42e5b1a7afdd47fcc453&quot;,&quot;70de3fbf064e4bfda3053549faaa48dc&quot;,&quot;7fd579c8215e44e5ae191b690ca09582&quot;,&quot;840dc7dfba9c4d5385d686625981c6b5&quot;,&quot;6d58203b39204144adf3e9bf3edaceaa&quot;,&quot;ca8c98929d7149f29cda3d2d07c4bbcd&quot;,&quot;b3c2f4fba0d842b39fa9fe2f04021792&quot;,&quot;7c94774f24684b6a8a983c0f88a69234&quot;,&quot;b6bf0d52335c4879bc46406f19a6f4c6&quot;,&quot;b0d0ee3e4520444baa878f91fd2d4deb&quot;,&quot;cd6488129db14876be0a91a50554ef9d&quot;,&quot;6cb4c6cab7284b4d8902577dc5b84cda&quot;,&quot;da5d7998d9c6459884c99cc7df5012d8&quot;,&quot;bbc71ba9b10a4bdba566b023142c6631&quot;,&quot;c086a46433e943dfb0fe0d51f3f62e7e&quot;,&quot;ede209bce4de4d6b869e34d49255f1b6&quot;,&quot;28a29faff3304ffdbb945e81a211c979&quot;,&quot;cd7a3bffbc7f4bdba1f20210e0fa3079&quot;,&quot;0c06266493c948edb6c1fc570ff9239f&quot;,&quot;fdaa27c3c12f4085a1268dcf58597e64&quot;,&quot;8869eecc4ab34b89b52498c0f8830d7f&quot;,&quot;29e24ddc6d514b8094b556aabe8ca27f&quot;,&quot;f6fb0f3f315f4871bef22b943f181149&quot;,&quot;f66f77802d2b4bfbaf3acba10527787c&quot;,&quot;79b106e34622498d9b42c72de4e93cd4&quot;,&quot;ee95eb1cd3694086a38eb69e7d185be3&quot;,&quot;9b886106508044f287568c4c4f6dafd0&quot;,&quot;1ced57e40dbf4863a030800ec510d1d4&quot;,&quot;3dc0bcd0848d494f9e6076f930b67c2f&quot;,&quot;a6d91a9b89114b2782cdf5b281e1dabc&quot;,&quot;e35681e1f49648b592ba1fb969a043b5&quot;,&quot;4b1f3d7928424add9b1f4dc37baf4de1&quot;,&quot;292406f2802f4f33812505034290d3ea&quot;,&quot;bb7217a52f9f4972bdbceb10616870ee&quot;,&quot;8f3ad7c067c846e09d457cd7864ceaa2&quot;,&quot;e74337070c0e4fd1aa77f5e17948b109&quot;,&quot;8eb5abef6c274daa993c946b64626bef&quot;,&quot;3c2665ee4322482886c59b3b080e1c4e&quot;,&quot;f08ecd9cb01941a8b1a173ef43748ffa&quot;,&quot;f4c28842ef23457a9c52eca98c78ef6d&quot;,&quot;dbfe295fc53241ce8d048010781f508e&quot;,&quot;eb9c420730cc4c43bf8772aa1a731436&quot;,&quot;e7217a6129224159bda95ddd2064e722&quot;,&quot;0809bf822b3e4ac59c55c49c21154126&quot;,&quot;00d31743a0bf43b293bfbe9c21aeccae&quot;,&quot;87a61bafb58c4c71b2f4575500d56f56&quot;,&quot;5854eed79fa04a3b851b12d89df59810&quot;,&quot;d59318bfd8454464b75d5c9108ee8d6d&quot;,&quot;5ec2cd41d59249e596828063c12aed9b&quot;,&quot;dda93c7b98524d50be777a60d9b5a3e2&quot;,&quot;dbf14028ffc145ff98447cac2240971c&quot;,&quot;a663d51afe04400cb4d96c69d05abfb5&quot;,&quot;88b6254d821741d2b276a397b678ab3d&quot;,&quot;a19a78f9697948f093495fa69d01a8b2&quot;,&quot;2920ba66f7f04e34b220c9a1d96a8073&quot;,&quot;c39628f723d7479da45b7777f780edaf&quot;,&quot;66a876745f6e4b53bb3d64bf2948b8a9&quot;,&quot;7ada7dca01b94b6981af199297ce00da&quot;,&quot;c1030851203f45c29df79de59c173ba5&quot;,&quot;483eebebf8914327979a9b9286ec5bc1&quot;,&quot;011ae2c3e5d94450b144424fd5109125&quot;,&quot;644a5a95bfcf4dd69a119ab83bb8cd01&quot;,&quot;1a587cb266964f46923351502f7222db&quot;,&quot;605de688a45843a891f1645eaa266b0c&quot;,&quot;735018f511ed46059bfc1fd04439cc88&quot;,&quot;f98d3d9671f14d4694a3940240f05271&quot;,&quot;2dd1f2814bb8484bbb5445c3dee7bb27&quot;,&quot;21ea180c98084acd85ccac4c2ec21934&quot;,&quot;d25eebbbdea745ae8719c45242c24953&quot;,&quot;b97d7570200444ca9d69fe029b4160d3&quot;,&quot;24a84a57bc9745239aee4438537bbedb&quot;,&quot;82a6c888c2e64c4e8f1d1fa3fcb16ec2&quot;,&quot;c6f340126f2d46c78c926d6ef0df0198&quot;,&quot;74a72f9815de4c8c80e53800816a9663&quot;,&quot;2dbac9dd9db643aa90fa0345020eed3c&quot;,&quot;2618c14b2ede4f9293b36e19c9df6f52&quot;,&quot;c80a833191384a03b3c91742d6cdbfb1&quot;,&quot;4d7da2970d924f548c9e0ee2ca86dca0&quot;,&quot;ead2dbf959a44ea5b02d778c2ed3df61&quot;,&quot;8ce803501e144ed19002a9e801fd8c03&quot;,&quot;a26d832e5c7548d09936f9643ce5d8f2&quot;,&quot;c1cb7dace45d4e9386bbf3479dddf635&quot;,&quot;3d0ceb1089aa40199a5bcb591ae4d76d&quot;,&quot;3139d02c705f426d949bb770860716f1&quot;,&quot;8aa353f86ff3422fa3a8288098846d80&quot;,&quot;cde2414d8fd64b948a9424412e0b31bc&quot;,&quot;3058190dce3041ed9dfe9e868c41e46c&quot;,&quot;1f764e2148e144138829cb10bfc7686e&quot;,&quot;7a806a48dfe24d07b16cfa35a57b1839&quot;,&quot;ab3b18572b024b569dd880578944d6d7&quot;,&quot;7dc9ad013e19420aa91499753d3cf917&quot;,&quot;466b0df6b033441abce98c27dc5dd12d&quot;,&quot;183a057b6d21424bb6b0b56547c0ef22&quot;,&quot;e1632f0c65c5455293e9a9906e32963a&quot;,&quot;48c1ae4fa7d94763afdc52ff839acf00&quot;,&quot;7abc877958cf4173bfb2c0f3371e32b5&quot;,&quot;24d5c3904a9343cfbbc7f01fb2e20abe&quot;,&quot;e407989d02744506964218b3a58d046c&quot;,&quot;bdc4be1d89ad41deabe375d89864af87&quot;,&quot;92488ba0e3fd4c898f2cee138973ddcf&quot;,&quot;a03525417ea041e9bb1828581af53200&quot;,&quot;24bee1cac7c542c0837468d11a6128ff&quot;,&quot;8183e2a14f6045dd90bce57a0a0bba94&quot;,&quot;8f0ceeafd5ff4aed828e265d0ede4333&quot;,&quot;d693b32f8f7848c3a7e371e366fc3cef&quot;,&quot;66aab4c65b8141e5a91f702562ec383d&quot;,&quot;2a83946719964ee68ff873a146c8ed61&quot;,&quot;0fd5ccfc01af47e6860325a356a6c5bb&quot;,&quot;1bc935e55e0b415e9aaffab20e8dfb90&quot;,&quot;009b6f0bae4f4eb1a27b8bda26c12df2&quot;,&quot;09a6f8e70e434584a632d0476bf80ba7&quot;,&quot;a4029f6615794666b51511518334a103&quot;,&quot;fa52ccb7dba34d8eaceb76c1f802d46c&quot;,&quot;80e0d17034d64e689ff0426e035f92c3&quot;,&quot;e98ab5806f77461382d57d4ef6ca290a&quot;,&quot;a460439190c1475fb7d55f6aac991325&quot;,&quot;75c5525181af4834817a076868c695ff&quot;,&quot;ba671575f6b34ebbb86c335680feeda6&quot;,&quot;bdc37094c64a4727a7208ea4fe7e7217&quot;,&quot;ba873446e3964ba296589f036b75b440&quot;,&quot;fe462a0edab44581b4c7708b47494962&quot;,&quot;5027443c92814a0c8d74202820ca9129&quot;,&quot;4f8ef209feb94183afa64a4cf8e7a4de&quot;,&quot;7b9072a6561b4d04b56d9456fe81a162&quot;,&quot;80781c28d7c94e3f89717ee471083a0e&quot;,&quot;8a8d27f9db76461daba0df9238453214&quot;,&quot;fb73f476f8d94e7dbcca40c7dcb51367&quot;,&quot;cf8139e7b83b4400ae9273e402680027&quot;,&quot;588816f06dac4452b8883bbedf40c8c2&quot;,&quot;f31c4d4037de43acbd8d96d2888d40ea&quot;,&quot;5b5ea66bedcb4aab85da37a30453cd7b&quot;,&quot;de2dc31ded2d467dbf5d4eb7b9c6bdb1&quot;,&quot;8c1bfd3790004e7484707afa6c006b31&quot;,&quot;3cec58521bf04b0fbf4a9e64f25eb7ff&quot;,&quot;67052712df5c41848101e322946de974&quot;,&quot;13c52dd935834c77be1f4821547bd92a&quot;,&quot;ef5cd74193d7425cb12dded287dcb445&quot;,&quot;f3acac1bff1c47299c884c35f99cf5d6&quot;,&quot;b82b06f0e4d24d90a69ab33b53c8561d&quot;,&quot;2f2674b5f62440449cc2f283371c5ea9&quot;,&quot;e9ec99fb65ed4a29aa5c99644150dedb&quot;,&quot;fca2105afdec44d1a1cbb967371d557e&quot;,&quot;0a4e6859abc84e6998dd7f7ff3604c75&quot;,&quot;fdbb2c6544564b67b04bcbbfe979391e&quot;,&quot;d219917c650d49029b7bb70c4dec65c0&quot;,&quot;98051c8e91644e3b8994924a57261120&quot;,&quot;bd6af9b72b984279bbb1666f0fdebbe9&quot;,&quot;f2f8379139c74566bb60e9b4da216190&quot;,&quot;ef90659ad8b24ca3b3b935b46ff4ff58&quot;,&quot;5e246d1bf5d14bc0b2222fc2e2bbf228&quot;,&quot;d844793cd4354263a87dadfa5bab9777&quot;,&quot;7a2826880565418b8ad6e4635b0590e2&quot;,&quot;753379cda602496db378097f4f584232&quot;,&quot;49bf361e3cf74fb49781d5fc2d70e145&quot;,&quot;a17b318b21944c9bbb724b03ac96f569&quot;,&quot;f45ce867f625491294994b976a638f03&quot;,&quot;60737568f12f491cb4e7f4e2d7061f44&quot;,&quot;eeb3a99e504c47aebcb9dd3b7f38ac04&quot;,&quot;e1f07a3894594b7298c41421e72e6276&quot;,&quot;1e60b4b165954b3bbca6819b508f4105&quot;,&quot;52ac0173ac1d4eb4865b0cbd589b26cd&quot;,&quot;4a909a2949844674ab41b2a1c1f85a06&quot;,&quot;a0335ae78ad54b069086bcf88d36c2b9&quot;,&quot;9261b2fabb04473c81d76ebe90dd1f78&quot;,&quot;2997763a032e403cbc0a532e5392066d&quot;,&quot;bfe6ad3555d040389e3fb138a7d55388&quot;,&quot;97a9d34a008a4e268c9c9d6d4a3a2246&quot;,&quot;1587db4dd62c4320b73e478b95dfbbac&quot;,&quot;876ac45a851e46a89cef4f53fb3bd245&quot;,&quot;1e98681280cb4144b641706d18375cf2&quot;,&quot;9c6e01a6fcd64ea1a8d0aba3b3a5051a&quot;,&quot;7c0cab73fdb3497b82925a8462e5e20c&quot;,&quot;15c8455325c349cb93992f0c9f8ea5d0&quot;,&quot;db5fe95397ca40e2a2b669103491622e&quot;,&quot;d72b407300d141789fea9031a058fd3a&quot;,&quot;a3677a080a024be79a36eba32054a98c&quot;,&quot;7d10b99d14664225accd74d936bb372e&quot;,&quot;0cd046435d23482c8ea4c4dab11f3379&quot;,&quot;85014683294a466faffd8a0eef349c9d&quot;,&quot;55694b8d787143c39abeed4a3ed92e11&quot;,&quot;a289e5a5a63e45b9bf8fa2163e3d62e1&quot;,&quot;e20c8becbd79460f9017cba0a9f33239&quot;,&quot;9c59d8aad92a432a9295b05fb11985a1&quot;,&quot;9fa32b02c3744d7f8d305fda36a08c57&quot;,&quot;90594303455442c18bd403fe8c4b16de&quot;,&quot;0be27634530f402b81383c8509404405&quot;,&quot;4cec0b7d46e947a6b97263bb63dbb838&quot;,&quot;1bc5f738ec2848bc89fc6fa3127b12b1&quot;,&quot;b794ce1b515e413aa260c4b9353292af&quot;,&quot;c0a8f8c9c59c47bb88d62b9970fc35da&quot;,&quot;3866bfbf25f94cf3b8e6bf73c0ffb2d0&quot;,&quot;4ca27a462e494fe79ebba4da76956c91&quot;,&quot;8fff733766764c0997e8ef31448cc693&quot;,&quot;0165924d478344d592c8b3ced21204ae&quot;,&quot;be400c6db7aa4eb3a4067e0cdfba9612&quot;,&quot;1498bc4c246f4eb993da69ba8d6146b8&quot;,&quot;c8dd8f6c87484dc1bbc48b2f526da0a1&quot;,&quot;b5b9bd08d9a04df7bd6b45120e0cb55d&quot;,&quot;4b84aa2caf9d4f38ababee4392dda38a&quot;,&quot;f735356290084a7baf098fe2621fdb8c&quot;,&quot;d3574c6d1c874062bef20adf2effe1b0&quot;,&quot;e0720111a5a043bbb3bf65334ee17f70&quot;,&quot;e7fdfb9272404c7f8618556388a9cac2&quot;,&quot;a42f865c1129455581ce1f9e64aaeec6&quot;,&quot;cc202df53d81435a95da398bde309b77&quot;,&quot;723ba513cdc04aa3ae45e224c829e1d1&quot;,&quot;ae7a24c59dd94e9788802a1c21681007&quot;,&quot;0dd6e277d84b4047aaf41ee4b69a5420&quot;,&quot;4ad61d38a1b04ce09f1c8f46e21d7272&quot;,&quot;e5785d040d6e4c659e3df6131e7719ee&quot;,&quot;56c0c24458f04da19c959171cfb609dd&quot;,&quot;1a8bf3d7e8c94571a3e5e6e25521af2c&quot;,&quot;39444604a64841f6ae276ada57ecee61&quot;,&quot;72251922274642a9a119864cea73486d&quot;,&quot;bece70b7d9e041dba1cedd997ba3e81b&quot;,&quot;381dc825323b4b9eb10992057291f185&quot;,&quot;8584640c1cc445bc83309136614799d2&quot;,&quot;611f8983df7243d9a5585fef297729d6&quot;,&quot;779a6c948ed8408485299919f5be4025&quot;,&quot;3df2b5cf845f45fe9cb5832778bd22e1&quot;,&quot;e571cd39fb0942089b205b700a3c004e&quot;,&quot;e7f580ea284641158ed6cfc76e767b59&quot;,&quot;97fc8285ee374fc78b0b24a8ca4d7718&quot;,&quot;fe4de185f6b6484c82e232c9947822ac&quot;,&quot;d848735ae89d4ea68dee0385447c87ad&quot;,&quot;625e1b054a13455d91dc609ea397e7f4&quot;,&quot;7eb151a3c18d4122a5b7937d8fcff7d1&quot;,&quot;9ab726dd2d514a10a41066890ca44a2d&quot;,&quot;7488b74edafc4dce925b6129ae5b29e6&quot;,&quot;47c1b8e9943847c7abd4879bac85d34e&quot;,&quot;f6ec55135a124310b932213d5910d81b&quot;,&quot;1156d74f227248fcae206ab602fc0455&quot;,&quot;43ea34d46be84a86b6984b98cc238626&quot;,&quot;443ccf5321f440e28beb88a3cd8c2325&quot;,&quot;2236e6dfd7d449159a1173970a0ccee5&quot;,&quot;8d0ce63e98f24047a5f5826c5fb238c8&quot;,&quot;fbc7aa2d67e24dd68d43d0df4a185114&quot;,&quot;18cdc078acd841d68c4cc08ceadf2e96&quot;,&quot;11aadb781a4e40c6afd95ac42dc5bca4&quot;,&quot;c9e710ca6b2b48279ef248426e75f697&quot;,&quot;0ff8ae55fa5a4dbea726316d4c653192&quot;,&quot;570a9e64e54a45fca98354c7192dab04&quot;,&quot;dd12cc19ec0443049c1ff7cbe14fa531&quot;,&quot;557f562f823c4de7a889a271237b2014&quot;,&quot;b8db51a9be5641d9adae0b2c8363c880&quot;,&quot;2dbc1c2222c94c3c98f9e2229a065081&quot;,&quot;bacc4f226b9d4222a8de2cce97104506&quot;,&quot;6a2c1f31f43f435daf7c296db2f40e1c&quot;,&quot;a084fb7223ea4344877e3462cf888de4&quot;,&quot;65cad40089b94c55a20d15ff894d3bfc&quot;,&quot;a59bc0b7976b4efd99cbc3422729287b&quot;,&quot;b043fdcfa92f46fb842d331ac4648eec&quot;,&quot;24037ea31ca84b7db75777549474004a&quot;,&quot;c91926605d934252b048b81b27bd9e9a&quot;,&quot;38185023a2bc4838b86b2de042dd691c&quot;,&quot;30c266a0bb5b43298c14d720def384a3&quot;,&quot;fb7050eb7a3f4f9fb33a5f0ae732505c&quot;,&quot;c191f998d712451b94e3deb2167cddcf&quot;,&quot;b99d3414812e4a7eb603d90a64e2c128&quot;,&quot;1b0ded85601d48fda7eaa7139da29502&quot;,&quot;1d6a3d718f914f85b07a1869d7408ba2&quot;,&quot;4e8de6bbc3344c0db33b74336766bdb4&quot;,&quot;bdf3a2723e02440dbfffe3b1d0d66184&quot;,&quot;b767d513700841dda24b9368833c1b94&quot;,&quot;a1a9e7aae57d47a7801b08e4acb85a5e&quot;,&quot;ac09f48954eb433693c7ef13cdccdf4f&quot;,&quot;a6607ec24251442ebcc9e154eb84551a&quot;,&quot;c64d239675134651bda8a018fc1d692f&quot;,&quot;735d3f5e1cd2489c8ebcafa30b6c96f8&quot;,&quot;b9556b958e974b46bab529f10156738d&quot;,&quot;33ed72960f6c4b2aac0ab23bc91f542b&quot;,&quot;5be06c66e8a64e98b0965aae8b82b390&quot;,&quot;1aab15935708478a8b7f46cf19e71cd1&quot;,&quot;353a00d43695464181ca9400fd65d221&quot;]}"
id="uvhT5BOpTll-" data-outputId="fd98ac7e-a565-4be5-f185-6477c3bac2ff">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>trainer.train()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training 0
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb43"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;e1852ed23eb34ac88d0c2dbd1b1a6283&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 0
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb45"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;f42ff74879cb41f0a48b1c22ad716f6c&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 1
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb47"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;380d84d18c7c4b388fdf42dce2dc3157&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 1
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb49"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;7734b9f1d288446f9177100f8ddde002&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 2
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb51"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;08f9d8ad54f944498a903b7313900481&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 2
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb53"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;721649f021154453b05dec6fb1f19afb&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 3
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb55"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;bc13945d02da4aa3adfe81457bbce05b&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 3
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb57"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;ff865bf1912542aba648f60f9541db53&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 4
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb59"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;e910eddbbc334967a3341e1186585291&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 4
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb61"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;d11722b4023840319531a6f8ad3c9fb3&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 5
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb63"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;86ec737c4d4e450e844922bc7b40e14f&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 5
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb65"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;d8e08b3b40ca4b3897e7f39e8529b97a&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 6
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb67"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;83526eae384d406fb05a8eeb84aa5bac&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 6
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb69"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;2ed1275dc5764355b02c52ce9d6c6154&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 7
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb71"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;4b9d4fb0ed41414c9fb30a7fe3611cd1&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 7
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb73"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;21bf468c99eb4c39b50237abd9af3d83&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 8
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb75"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;cd6488129db14876be0a91a50554ef9d&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 8
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb77"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;29e24ddc6d514b8094b556aabe8ca27f&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 9
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb79"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;292406f2802f4f33812505034290d3ea&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 9
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb81"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;0809bf822b3e4ac59c55c49c21154126&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 10
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb83"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;2920ba66f7f04e34b220c9a1d96a8073&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 10
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb85"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;f98d3d9671f14d4694a3940240f05271&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 11
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb87"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;c80a833191384a03b3c91742d6cdbfb1&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 11
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb89"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;1f764e2148e144138829cb10bfc7686e&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 12
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb91"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;bdc4be1d89ad41deabe375d89864af87&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 12
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb93"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;009b6f0bae4f4eb1a27b8bda26c12df2&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 13
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb95"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;fe462a0edab44581b4c7708b47494962&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 13
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb97"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;de2dc31ded2d467dbf5d4eb7b9c6bdb1&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 14
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb99"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;0a4e6859abc84e6998dd7f7ff3604c75&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 14
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb101"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;49bf361e3cf74fb49781d5fc2d70e145&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 15
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb103"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;2997763a032e403cbc0a532e5392066d&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 15
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb105"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;a3677a080a024be79a36eba32054a98c&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 16
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb107"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;4cec0b7d46e947a6b97263bb63dbb838&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 16
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb109"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b5b9bd08d9a04df7bd6b45120e0cb55d&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 17
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb111"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;4ad61d38a1b04ce09f1c8f46e21d7272&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 17
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb113"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;3df2b5cf845f45fe9cb5832778bd22e1&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 18
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb115"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;f6ec55135a124310b932213d5910d81b&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 18
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb117"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;570a9e64e54a45fca98354c7192dab04&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Training 19
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb119"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;24037ea31ca84b7db75777549474004a&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>Eval epoch 19
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb121"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b767d513700841dda24b9368833c1b94&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell code" data-execution_count="37" id="M73XSsoYVzOg">
<div class="sourceCode" id="cb122"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="38" id="1iHv7SreVcNL">
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>losses_df <span class="op">=</span> pd.DataFrame(trainer.losses)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>acc_df <span class="op">=</span> pd.DataFrame(trainer.accuracy)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="39"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="V86HinceVihI" data-outputId="83987692-ee1f-46e8-f0a3-cffd0ef854a0">
<div class="sourceCode" id="cb124"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.lineplot(losses_df)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">&#39;Epoch&#39;</span>, ylabel<span class="op">=</span><span class="st">&#39;Loss&#39;</span>, title<span class="op">=</span><span class="st">&#39;Train/Validation Loss&#39;</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_481d8aea3d83438094e7403a071fad0e/4704eac2c98a1995831f43231ec4d3c37f34cb21.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="5MT7RKjVTnYl" data-outputId="946d15db-37bc-4339-addb-fdba96603fa2">
<div class="sourceCode" id="cb125"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.lineplot(acc_df)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">&#39;Epoch&#39;</span>, ylabel<span class="op">=</span><span class="st">&#39;Accuracy&#39;</span>, title<span class="op">=</span><span class="st">&#39;Train/Validation Accuracy&#39;</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_481d8aea3d83438094e7403a071fad0e/b188ecdd1edd7ba885637f9ac47faa45a28b7911.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Looking at two above plots, we can see our model behaves the best at
epoch 9-10, with the accuracy is nearly 96%. After that, the accuracy
drop, it can be explained by overfitting, model just focuses on training
data, loose the generalization. Finally, the output of epoch 10 is used
for hosting application.</p>
</div>
<div class="cell markdown">

</div>
<div class="cell code" id="g6atFFcJU7eh">
<div class="sourceCode" id="cb126"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
